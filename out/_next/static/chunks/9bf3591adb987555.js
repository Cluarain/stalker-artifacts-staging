(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,40206,e=>{"use strict";var a=e.i(43476),t=e.i(18566),s=e.i(22016),r=e.i(71645);e.i(85269);var l=e.i(22831);function n(){let{t:e}=(0,l.useTranslation)(),n=(0,t.usePathname)(),[i,c]=(0,r.useState)([]);return((0,r.useEffect)(()=>{var a=n.split("/").filter(e=>""!==e),t=[];t.push({label:e("homePage"),href:"/",isActive:"/"===n});var s="";a.forEach((r,l)=>{if("games"!==r){let i;s+=`/${r}`;var n=l===a.length-1;t.push({label:(i={"":e("homePage"),games:e("gamePage")})[r]?i[r]:r.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),href:s,isActive:n})}}),c(t)},[n]),i.length<=1)?null:(0,a.jsx)("nav",{className:"breadcrumbs custom-font",children:(0,a.jsx)("ol",{className:"breadcrumb-list",children:i.map((e,t)=>(0,a.jsxs)("li",{className:"breadcrumb-item",children:[t>0&&(0,a.jsx)("span",{className:"breadcrumb-separator",children:"·"}),e.isActive?(0,a.jsx)("span",{className:"breadcrumb-current",children:e.label}):(0,a.jsx)(s.default,{href:e.href,className:"breadcrumb-link",children:e.label})]},e.href))})})}e.s(["default",()=>n])},89776,e=>{"use strict";let a="/stalker-artifacts-staging";function t(e){let t=a.replace(/\/$/,""),s=e.startsWith("/")?e:`/${e}`;return e.startsWith(a)||e.startsWith(t)?s:`${t}${s}`}e.s(["getPath",()=>t])},26593,e=>{"use strict";var a=e.i(43476),t=e.i(40206),s=e.i(71645),r=e.i(97546),l=e.i(55613),n=e.i(89776),i=e.i(50562),c=e.i(48742),o=e.i(71282);e.i(85269);var d=e.i(22831);let m={slug:"empty",title:"gameEmpty",mod:"roundValue",dataFiles:{actor:"/games/empty/dataFiles/actor.json",artifactsParams:"/games/empty/dataFiles/artifactsParams.json"}};function u({games:e}){let[u,h]=(0,s.useState)(null),[p,x]=(0,s.useState)(null),[f,j]=(0,s.useState)(""),[g,v]=(0,s.useState)(""),[N,y]=(0,s.useState)(""),[b,k]=(0,s.useState)(""),[_,P]=(0,s.useState)([]),[F,S]=(0,s.useState)({}),[w,C]=(0,s.useState)(!1),[A,$]=(0,s.useState)([]),[E,O]=(0,s.useState)([]),[T,L]=(0,s.useState)([]),[B,J]=(0,s.useState)([]),[G,K]=(0,s.useState)([]),[I,W]=(0,s.useState)([]),[D,R]=(0,s.useState)("json"),[V,z]=(0,s.useState)("json"),M=(0,s.useRef)(null),{t:U}=(0,d.useTranslation)();(0,s.useEffect)(()=>{(async()=>{if(u?.data?.dataFiles){C(!0);try{if(u.data?.slug==="empty"){let e=Object.keys(u.data.dataFiles),a=e.map(e=>fetch((0,n.getPath)(`/games/${u.data.slug}/dataFiles/${e}.json`))),t=await Promise.all(a);if(!t.every(e=>e.ok))throw Error("Ошибка загрузки данных");let s=await Promise.all(t.map(e=>e.json())),r={actor:{},artifacts:{}};e.forEach((e,a)=>{r[e]=s[a]}),console.log("Empty game data loaded:",r),x(r),j(u?.data?.mod||"")}else{let e=Object.keys(u.data.dataFiles).filter(e=>"strings"!==e),a=e.map(e=>fetch((0,n.getPath)(`/games/${u.data.slug}/dataFiles/${e}.json`))),t=await Promise.all(a);if(!t.every(e=>e.ok))throw Error("Ошибка загрузки данных");let s=await Promise.all(t.map(e=>e.json())),r={actor:{},artifacts:{}};e.forEach((e,a)=>{r[e]=s[a]}),console.log("gameDataResult",r),x(r),j(u?.data?.mod||""),y(JSON.stringify(r?.actor.actor_condition,null,4)),k(JSON.stringify(r?.artifactsParams,null,4))}}catch(e){console.error("Ошибка при загрузке данных игры:",e),x(null)}finally{C(!1)}}})()},[u]);let Z=(e,a="")=>{let t="";for(let s in e)if(e.hasOwnProperty(s)){let r=e[s],l=a?`${a}.${s}`:s;if("object"!=typeof r||null===r||Array.isArray(r)){let e;e="boolean"==typeof r?r?"true":"false":r.toString(),t+=`${l} = ${e}
`}else t+=Z(r,l)}return t},H=(e,a)=>{let t=[],s=[];try{if(e.trim()){let t=JSON.parse(e);x(e=>e?{...e,[a]:t}:{actor:{},artifacts:{},artifactsParams:{},[a]:t}),"actor"===a?(L([]),K([])):(J([]),W([]));return}}catch(e){}let r=e.split("\n"),l={};r.forEach((e,a)=>{let s=e.split(";")[0].trim();if(!s||s.includes("["))return;let r=s.match(/^([a-zA-Z0-9_.]+)\s*=\s*(.+)$/);if(r){let[,e,a]=r,t=e.trim(),s=a.trim(),n=s;"true"===s.toLowerCase()?n=!0:"false"===s.toLowerCase()?n=!1:isNaN(Number(s))||(n=Number(s));let i=t.split("."),c=l;for(let e=0;e<i.length-1;e++)c[i[e]]||(c[i[e]]={}),c=c[i[e]];c[i[i.length-1]]=n}else t.push(`row #${a+1}: invalid format "${s}"`)}),t.length>0?"actor"===a?(L(t),K(s)):(J(t),W(s)):"actor"===a?(L([]),K(s)):(J([]),W(s)),x(e=>e?{...e,[a]:l}:{actor:{},artifacts:{},artifactsParams:{},[a]:l})};(0,s.useEffect)(()=>{x(null),v(""),y(""),k(""),P([]),S({}),$([]),O([]),L([]),J([]),K([]),W([]),u?.data?.slug==="empty"&&x({actor:{},artifacts:{},artifactsParams:{}})},[u]);let q=e=>{let a=e.split("\n"),t=[],s=[],r=[],l=new Set;return a.forEach((e,a)=>{let n=a+1,i=e.split(";")[0].trim();if(!i)return;let c=i.match(/^([a-zA-Z0-9_]+)\s*=\s*([+-]?(?:\d+\.?\d*|\.\d+)(?:[eE][+-]?\d+)?|[a-zA-Z0-9_.,]+)$/);if(c){let[,e,a]=c,s=e.trim(),o=a.trim();l.has(s)?r.push(U("translation:lineDuplicateKey",{lineNumber:n,key:s})):l.add(s),t.push({key:s,value:o,originalLine:i,lineNumber:n})}else s.push(`Строка ${n}: неверный формат "${i}"`)}),$(s),O(r),t};(0,s.useEffect)(()=>{let e={};_.forEach(a=>{if(a.key&&a.value)try{let n=parseFloat(a.value);var t=isNaN(n)?a.value:n,s=(0,r.formatValue)(a.key,t,p,U,f),l=(0,r.formatParamName)(a.key,f);l===a.key&&(l=U(`translation:${a.key}`));let[i,c]=(0,r.getColorClassAndSign)(a.key,t,f);e[a.key]={name:l,text:`<span class="sign-value-unit ${i}"><span class="_sign">${c}</span>${s}</span>`}}catch(t){console.error("Ошибка расчета:",t),e[a.key]={name:a.key,text:`<span class="error">Ошибка расчета: ${t}</span>`}}}),S(e)},[_,p,f,U]);let Q=_.reduce((e,a)=>{if(a.key){let t=parseFloat(a.value);isNaN(t)||(e[a.key]=t)}return e},{}),X=Array.from(new Set(_.map(e=>e.key))),Y=u?.data?.slug==="empty",ee=[{value:m.slug,label:U(`translation:${m.title}`),data:m},...e.map(e=>({value:e.slug,label:U(`translation:${e.title}`),data:e}))];return(0,a.jsxs)("main",{className:"content-grid",children:[(0,a.jsx)("header",{className:"home-header",children:(0,a.jsx)("h1",{children:U("translation:calculatorPageHeader")})}),(0,a.jsx)(t.default,{}),(0,a.jsxs)("div",{className:"calculator",children:[(0,a.jsxs)("div",{className:"calculator-header",children:[(0,a.jsx)(l.default,{unstyled:!0,styles:o.selectStyles,className:"stalker-select-container",classNamePrefix:"stalker-select",instanceId:"calculatorSelectGame",options:ee,value:u,onChange:e=>h(e||null),getOptionLabel:e=>e.label,getOptionValue:e=>e.value,placeholder:U("translation:selectGamePlaceholder"),isClearable:!0}),!u&&(0,a.jsx)("p",{className:"text_muted",children:U("translation:selectGameForStart")}),u?.data?.slug==="empty"&&(0,a.jsxs)("div",{className:"empty-game-info",children:[(0,a.jsx)("p",{className:"text_muted",children:U("translation:emptyGameManualMode")}),(0,a.jsx)("p",{className:"text_muted small",children:U("translation:emptyGameFillFields")})]}),u&&u.data?.slug!=="empty"&&!p&&(0,a.jsx)("p",{className:"negative",children:U("translation:unlockInputSelectGame")}),w&&(0,a.jsx)("div",{children:U("translation:loadingGameData")}),p&&u?.data?.slug!=="empty"&&!w&&(0,a.jsx)("div",{className:"text_muted",children:U("translation:gameDataLoadedSuccessfully")})]}),(0,a.jsxs)("div",{className:"calculator-body artifact-stats",children:[u&&(0,a.jsxs)("div",{className:"textarea-group",children:[(0,a.jsxs)("fieldset",{children:[(0,a.jsxs)("legend",{children:[(0,a.jsx)("code",{children:"actor.ltx"}),Y&&T.length>0&&(0,a.jsxs)("span",{className:"parse-error-count",children:[U("translation:errorsCount")," ",T.length]})]}),Y&&(0,a.jsxs)("div",{className:"text-area-controls-row",children:[(0,a.jsxs)("div",{className:"format-toggle",children:[(0,a.jsxs)("div",{className:"stalker-checkbox-container",children:[(0,a.jsx)("input",{id:"input_ActorFormatJson",checked:"json"===D,className:"stalker-checkbox-input",type:"radio",name:"actorFormat",value:"json",onChange:()=>R("json")}),(0,a.jsx)("label",{htmlFor:"input_ActorFormatJson",className:"stalker-checkbox-label",children:U("translation:formatJson")})]}),(0,a.jsxs)("div",{className:"stalker-checkbox-container",children:[(0,a.jsx)("input",{id:"input_ActorFormatKey",checked:"keyvalue"===D,className:"stalker-checkbox-input",type:"radio",name:"actorFormat",value:"keyvalue",onChange:()=>R("keyvalue")}),(0,a.jsx)("label",{htmlFor:"input_ActorFormatKey",className:"stalker-checkbox-label",children:U("translation:formatKeyValue")})]})]}),(0,a.jsxs)("div",{className:"text-area-controls",children:[(0,a.jsx)("button",{type:"button",className:"form-control",onClick:()=>{let e;if(p?.actor){if("json"===D)e=JSON.stringify(p.actor.actor_condition,null,4);else{var a;e=Z((a=p.actor).actor_condition||a)}y(e),H(e,"actor")}},disabled:!Y||!p?.actor,title:U("translation:insertActorExampleButton"),children:U("translation:insertActorExampleButton")}),(0,a.jsx)("button",{type:"button",className:"form-control",onClick:()=>{y(""),x(e=>e?{...e,actor:{}}:{actor:{},artifacts:{},artifactsParams:{}}),L([]),K([])},disabled:!Y||!N,title:U("translation:clearButton"),children:U("translation:clearButton")})]})]}),(0,a.jsx)("textarea",{ref:M,id:"actorTextArea",className:"form-control actor-textarea",value:N,onChange:e=>{let a=e.target.value;y(a),u?.data?.slug==="empty"&&H(a,"actor")},readOnly:!Y,wrap:"off",rows:12,spellCheck:"false",placeholder:Y?"json"===D?`Формат JSON:
{
    "health_restore_speed": 0.0003,
    "radiation_restore_speed": 0.004
}`:`Формат key=value:
health_restore_speed = 0.0003
radiation_restore_speed = 0.004`:""}),Y&&(0,a.jsxs)(a.Fragment,{children:[T.length>0&&(0,a.jsx)("div",{className:"parse-errors",children:T.map((e,t)=>(0,a.jsx)("div",{className:"parse-error-item",children:e},t))}),G.length>0&&(0,a.jsx)("div",{className:"parse-warnings",children:G.map((e,t)=>(0,a.jsx)("div",{className:"warning-item",children:e},t))})]})]}),u?.data?.dataFiles?.artifactsParams&&(0,a.jsxs)("fieldset",{children:[(0,a.jsxs)("legend",{children:[(0,a.jsx)("code",{children:"af_params.xml"}),Y&&B.length>0&&(0,a.jsxs)("span",{className:"parse-error-count",children:["Ошибок: ",B.length]})]}),Y&&(0,a.jsxs)("div",{className:"text-area-controls-row",children:[(0,a.jsxs)("div",{className:"format-toggle",children:[(0,a.jsxs)("div",{className:"stalker-checkbox-container",children:[(0,a.jsx)("input",{id:"input_artParamsFormatFormatJson",checked:"json"===V,className:"stalker-checkbox-input",type:"radio",name:"artParamsFormat",value:"json",onChange:()=>z("json")}),(0,a.jsx)("label",{htmlFor:"input_artParamsFormatFormatJson",className:"stalker-checkbox-label",children:U("translation:formatJson")})]}),(0,a.jsxs)("div",{className:"stalker-checkbox-container",children:[(0,a.jsx)("input",{id:"input_artParamsFormatFormatKey",checked:"keyvalue"===V,className:"stalker-checkbox-input",type:"radio",name:"artParamsFormat",value:"keyvalue",onChange:()=>z("keyvalue")}),(0,a.jsx)("label",{htmlFor:"input_artParamsFormatFormatKey",className:"stalker-checkbox-label",children:U("translation:formatKeyValue")})]})]}),(0,a.jsxs)("div",{className:"text-area-controls",children:[(0,a.jsx)("button",{type:"button",className:"form-control",onClick:()=>{let e;p?.artifactsParams&&(k(e="json"===V?JSON.stringify(p.artifactsParams,null,4):Z(p.artifactsParams)),H(e,"artifactsParams"))},disabled:!Y||!p?.artifactsParams,title:U("translation:insertArtParamsExampleButton"),children:U("translation:insertArtParamsExampleButton")}),(0,a.jsx)("button",{type:"button",className:"form-control",onClick:()=>{k(""),x(e=>e?{...e,artifactsParams:{}}:{actor:{},artifacts:{},artifactsParams:{}}),J([]),W([])},disabled:!Y||!b,title:U("translation:clearButton"),children:U("translation:clearButton")})]})]}),(0,a.jsx)("textarea",{ref:M,id:"artParamsTextArea",className:"form-control art-params-textarea",value:b,onChange:e=>{let a=e.target.value;k(a),u?.data?.slug==="empty"&&H(a,"artifactsParams")},readOnly:!Y,wrap:"off",rows:12,spellCheck:"false",placeholder:Y?"json"===V?`Формат JSON:
{
    "health_restore_speed": {
      "magnitude": 10000,
    }
}`:`Формат key=value:
health_restore_speed.min = 0.0001
health_restore_speed.max = 0.0005`:""}),Y&&(0,a.jsxs)(a.Fragment,{children:[B.length>0&&(0,a.jsx)("div",{className:"parse-errors",children:B.map((e,t)=>(0,a.jsx)("div",{className:"parse-error-item",children:e},t))}),I.length>0&&(0,a.jsx)("div",{className:"parse-warnings",children:I.map((e,t)=>(0,a.jsx)("div",{className:"warning-item",children:e},t))})]})]})]}),(0,a.jsxs)("div",{className:"textarea-group",children:[(0,a.jsxs)("fieldset",{className:"fieldset-art-stats",children:[(0,a.jsx)("legend",{children:(0,a.jsx)("code",{children:"items_artefacts.ltx"})}),(0,a.jsxs)("div",{className:"input-with-label",children:[(0,a.jsxs)("label",{htmlFor:"modInput",children:[U("translation:modInputLabel"),":"]}),(0,a.jsx)("input",{id:"modInput",className:"form-control",type:"text",value:f,onChange:e=>j(e.target.value),placeholder:"modifiers",disabled:!p,autoComplete:"off"})]}),(0,a.jsxs)("div",{className:"input-with-label",children:[(0,a.jsx)("label",{htmlFor:"statsTextArea",children:U("translation:artifactStatsInputLabel")}),(0,a.jsxs)("div",{className:"text-area-controls",children:[(0,a.jsx)("button",{type:"button",className:"form-control",onClick:()=>{var e=Z({radiation_restore_speed:47e-5,power_restore_speed:-88e-5,bleeding_restore_speed:-124e-6,strike_immunity:.034,wound_immunity:.034,explosion_immunity:.034,fire_wound_immunity:.034});v(e),P(q(e)),setTimeout(()=>{M.current&&M.current.focus()},0)},disabled:!p,title:U("translation:artifactExampleButton"),children:U("translation:artifactExampleButton")}),(0,a.jsx)("button",{type:"button",className:"form-control",onClick:()=>{v(""),P([]),$([]),O([]),S({}),setTimeout(()=>{M.current&&M.current.focus()},0)},disabled:!p||!g,title:U("translation:clearButton"),children:U("translation:clearButton")})]})]}),(0,a.jsx)("textarea",{ref:M,id:"statsTextArea",className:"form-control stats-textarea",value:g,onChange:e=>{let a=e.target.value;v(a),a.trim()?P(q(a)):(P([]),$([]),O([]))},placeholder:`Введите параметры в формате:
ключ = значение  ; комментарий

Пример:
health_restore_speed = 0.0003 ; восстановление здоровья
radiation_restore_speed = 0.004   ; комментарии после ";" игнорируются`,disabled:!p,wrap:"off",rows:8,spellCheck:"false"})]}),(0,a.jsxs)("fieldset",{children:[(0,a.jsx)("legend",{children:(0,a.jsx)("code",{children:"Results"})}),(0,a.jsxs)("div",{className:"textarea-info",children:[(0,a.jsxs)("div",{className:"text_muted",children:[U("translation:recognizedParamsCount")," ",_.length]}),A.length>0&&(0,a.jsxs)("div",{className:"parse-errors",children:[(0,a.jsx)("div",{className:"parse-errors-title",children:U("translation:formatErrorsTitle")}),A.map((e,t)=>(0,a.jsx)("div",{className:"parse-error-item",children:e},t))]}),E.length>0&&(0,a.jsxs)("div",{className:"parse-warnings",children:[(0,a.jsx)("div",{className:"warnings-title",children:U("translation:duplicateWarningsTitle")}),E.map((e,t)=>(0,a.jsx)("div",{className:"warning-item",children:e},t))]})]}),p?0===_.length?(0,a.jsx)("p",{className:"text_muted",children:U("translation:enterParamsForCalculation")}):Object.keys(F).length>0?(0,a.jsx)("div",{className:"results-container",children:X.map(e=>{let t=F[e],s=_.filter(a=>a.key===e);return(0,a.jsxs)("div",{className:"result-item",children:[(0,a.jsxs)("div",{className:"result-header",children:[(0,a.jsx)(c.default,{title:e,placement:"right",children:(0,a.jsx)("span",{className:"result-name",children:t?.name||e})}),s.length>1&&(0,a.jsxs)("span",{className:"duplicate-count",children:["(",s.length,"×)"]})]}),(0,a.jsx)("div",{className:"result-content",children:(0,a.jsx)("span",{className:"result-text",dangerouslySetInnerHTML:{__html:t?.text||'<span class="parse-errors">Не удалось рассчитать</span>'}})})]},e)})}):(0,a.jsx)("p",{className:"text_muted",children:U("translation:enterDataForCalculation")}):(0,a.jsx)("p",{className:"text_muted",children:U("translation:startCalculationsSelectGame")})]})]})]}),(0,a.jsx)("div",{className:"calculator-footer",children:Object.keys(Q).length>0&&(0,a.jsx)(i.default,{acTitle:U("translation:debugAccordionTitle",{count:Object.keys(Q).length}),acBody:(0,a.jsxs)("div",{children:[(0,a.jsx)("pre",{style:{margin:0,whiteSpace:"pre-wrap"},children:JSON.stringify(Q,null,2)}),(0,a.jsxs)("div",{className:"debug-info",children:[(0,a.jsxs)("div",{children:[U("translation:modifierLabel"),f||""]}),(0,a.jsxs)("div",{children:[U("translation:errorsLabel"),A.length]}),(0,a.jsxs)("div",{children:[U("translation:warningsLabel"),E.length]}),Y&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[U("translation:actorWarningsLabel"),G.length]}),(0,a.jsxs)("div",{children:[U("translation:artParamsWarningsLabel"),I.length]})]}),(0,a.jsxs)("div",{children:[U("translation:gameTypeLabel")," ",Y?U("translation:emptyGameType"):U("translation:presetGameType")]}),Y&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[U("translation:actorFormatLabel"),D]}),(0,a.jsxs)("div",{children:[U("translation:artParamsFormatLabel"),V]})]})]})]}),additionalClass:"debug-accordion"})})]})]})}e.s(["default",()=>u])}]);