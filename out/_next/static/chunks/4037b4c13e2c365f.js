(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,40206,e=>{"use strict";var a=e.i(43476),t=e.i(18566),s=e.i(22016),r=e.i(71645);e.i(85269);var l=e.i(22831);function n({initialBreadcrumbs:e}={}){let{t:i}=(0,l.useTranslation)(),c=(0,t.usePathname)(),[o,d]=(0,r.useState)(e||[]);return((0,r.useEffect)(()=>{if(e&&e.length>0)return void d(e);var a=c.split("/").filter(e=>""!==e),t=[];t.push({label:i("homePage"),href:"/",isActive:"/"===c});var s="";a.forEach((e,r)=>{if("games"!==e){let n;s+=`/${e}`;var l=r===a.length-1;t.push({label:(n={"":i("homePage"),games:i("gamePage")})[e]?n[e]:e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),href:s,isActive:l})}}),d(t)},[c,e]),o.length<=1)?null:(0,a.jsx)("nav",{className:"breadcrumbs custom-font",children:(0,a.jsx)("ol",{className:"breadcrumb-list",children:o.map((e,t)=>(0,a.jsxs)("li",{className:"breadcrumb-item",children:[t>0&&(0,a.jsx)("span",{className:"breadcrumb-separator",children:"·"}),e.isActive?(0,a.jsx)("span",{className:"breadcrumb-current",children:i(e.label)}):(0,a.jsx)(s.default,{href:e.href,className:"breadcrumb-link",children:i(e.label)})]},e.href))})})}e.s(["default",()=>n])},89776,e=>{"use strict";let a="/stalker-artifacts-staging";function t(e){let t=a.replace(/\/$/,""),s=e.startsWith("/")?e:`/${e}`;return e.startsWith(a)||e.startsWith(t)?s:`${t}${s}`}e.s(["getPath",()=>t])},26593,e=>{"use strict";var a=e.i(43476),t=e.i(40206),s=e.i(71645),r=e.i(97546),l=e.i(55613),n=e.i(34282),i=e.i(50562),c=e.i(48742),o=e.i(71282);e.i(85269);var d=e.i(22831);let m={slug:"empty",title:"gameEmpty",mod:"roundValue",dataFiles:{actor:"/games/empty/dataFiles/actor.json",artifactsParams:"/games/empty/dataFiles/artifactsParams.json"}};function u({games:e}){let[u,h]=(0,s.useState)(null),[p,x]=(0,s.useState)(null),[j,f]=(0,s.useState)(""),[g,v]=(0,s.useState)(""),[N,y]=(0,s.useState)(""),[b,k]=(0,s.useState)(""),[_,F]=(0,s.useState)([]),[S,P]=(0,s.useState)({}),[C,w]=(0,s.useState)(!1),[A,$]=(0,s.useState)([]),[T,E]=(0,s.useState)([]),[O,L]=(0,s.useState)([]),[B,J]=(0,s.useState)([]),[G,K]=(0,s.useState)([]),[D,I]=(0,s.useState)([]),[V,W]=(0,s.useState)("json"),[M,z]=(0,s.useState)("json"),R=(0,s.useRef)(null),{i18n:U,t:Z}=(0,d.useTranslation)(),H={actor:{},artifacts:{},artifactsParams:{},strings:{}};(0,s.useEffect)(()=>{(async()=>{if(u?.data?.dataFiles){w(!0);try{let e=await (0,n.loadDataFiles)(u.data,U);x(e.gameData),w(e.loading),e.errors&&console.error(e.errors),f(u?.data?.mod||""),y(JSON.stringify(e.gameData?.actor.actor_condition,null,4)),k(JSON.stringify(e.gameData?.artifactsParams,null,4))}catch(e){w(!1)}}})()},[u]);let q=(e,a="")=>{let t="";for(let s in e)if(e.hasOwnProperty(s)){let r=e[s],l=a?`${a}.${s}`:s;if("object"!=typeof r||null===r||Array.isArray(r)){let e;e="boolean"==typeof r?r?"true":"false":r.toString(),t+=`${l} = ${e}
`}else t+=q(r,l)}return t},Q=(e,a)=>{let t=[],s=[];var r=!1;try{if(e.trim()){let t=JSON.parse(e);x(e=>e?"actor"===a?{...e,actor:{...e.actor,actor_condition:t}}:{...e,[a]:t}:"actor"===a?{...H,actor:{actor_condition:t}}:{...H,[a]:t}),"actor"===a?(L([]),K([])):(J([]),I([])),r=!0;return}}catch(e){r=!1}if(!r&&e){let r=e.split("\n"),l={};r.forEach((e,a)=>{let s=e.split(";")[0].trim();if(!s||s.includes("["))return;let r=s.match(/^([a-zA-Z0-9_.]+)\s*=\s*(.+)$/);if(r){let[,e,a]=r,t=e.trim(),s=a.trim(),n=s;"true"===s.toLowerCase()?n=!0:"false"===s.toLowerCase()?n=!1:isNaN(Number(s))||(n=Number(s));let i=t.split("."),c=l;for(let e=0;e<i.length-1;e++)c[i[e]]||(c[i[e]]={}),c=c[i[e]];c[i[i.length-1]]=n}else t.push(`row #${a+1}: invalid format "${s}"`)}),t.length>0?"actor"===a?(L(t),K(s)):(J(t),I(s)):"actor"===a?(L([]),K(s)):(J([]),I(s)),x(e=>e?"actor"===a?{...e,actor:{...e.actor,actor_condition:l}}:{...e,[a]:l}:"actor"===a?{...H,actor:{actor_condition:l}}:{...H,[a]:l})}};(0,s.useEffect)(()=>{x(null),v(""),y(""),k(""),F([]),P({}),$([]),E([]),L([]),J([]),K([]),I([]),u?.data?.slug==="empty"&&x(H)},[u]);let X=e=>{let a=e.split("\n"),t=[],s=[],r=[],l=new Set;return a.forEach((e,a)=>{let n=a+1,i=e.split(";")[0].trim();if(!i)return;let c=i.match(/^([a-zA-Z0-9_]+)\s*=\s*([+-]?(?:\d+\.?\d*|\.\d+)(?:[eE][+-]?\d+)?|[a-zA-Z0-9_.,]+)$/);if(c){let[,e,a]=c,s=e.trim(),o=a.trim();l.has(s)?r.push(Z("translation:lineDuplicateKey",{lineNumber:n,key:s})):l.add(s),t.push({key:s,value:o,originalLine:i,lineNumber:n})}else s.push(`Строка ${n}: неверный формат "${i}"`)}),$(s),E(r),t};(0,s.useEffect)(()=>{let e={};_.forEach(a=>{if(a.key&&a.value)try{let n=parseFloat(a.value);var t=isNaN(n)?a.value:n,s=(0,r.formatValue)(a.key,t,{gameMetadata:u.data,...p},Z,j),l=(0,r.formatParamName)({key:a.key,t:Z,rawValue:!0,gameMetadata:u.data,gameData:p});let[i,c]=(0,r.getColorClassAndSign)(a.key,t,j);e[a.key]={name:l,text:`<span class="sign-value-unit ${i}"><span class="_sign">${c}</span>${s}</span>`}}catch(t){console.error("Ошибка расчета:",t),e[a.key]={name:a.key,text:`<span class="error">Ошибка расчета: ${t}</span>`}}}),P(e)},[_,p,j,Z]);let Y=_.reduce((e,a)=>{if(a.key){let t=parseFloat(a.value);isNaN(t)||(e[a.key]=t)}return e},{}),ee=Array.from(new Set(_.map(e=>e.key))),ea=u?.data?.slug==="empty",et=[{value:m.slug,label:Z(`translation:${m.title}`),data:m},...e.map(e=>({value:e.slug,label:Z(`translation:${e.title}`),data:e}))];return(0,a.jsxs)("main",{className:"content-grid",children:[(0,a.jsx)("header",{className:"home-header",children:(0,a.jsx)("h1",{children:Z("translation:calculatorPageHeader")})}),(0,a.jsx)(t.default,{}),(0,a.jsxs)("div",{className:"calculator",children:[(0,a.jsxs)("div",{className:"calculator-header",children:[(0,a.jsx)(l.default,{unstyled:!0,styles:o.selectStyles,className:"stalker-select-container",classNamePrefix:"stalker-select",instanceId:"calculatorSelectGame",options:et,value:u,onChange:e=>h(e||null),getOptionLabel:e=>e.label,getOptionValue:e=>e.value,placeholder:Z("translation:selectGamePlaceholder"),isClearable:!0}),!u&&(0,a.jsx)("p",{className:"text_muted",children:Z("translation:selectGameForStart")}),u?.data?.slug==="empty"&&(0,a.jsxs)("div",{className:"empty-game-info",children:[(0,a.jsx)("p",{className:"text_muted",children:Z("translation:emptyGameManualMode")}),(0,a.jsx)("p",{className:"text_muted small",children:Z("translation:emptyGameFillFields")})]}),u&&u.data?.slug!=="empty"&&!p&&(0,a.jsx)("p",{className:"negative",children:Z("translation:unlockInputSelectGame")}),C&&(0,a.jsx)("div",{children:Z("translation:loadingGameData")}),p&&u?.data?.slug!=="empty"&&!C&&(0,a.jsx)("div",{className:"text_muted",children:Z("translation:gameDataLoadedSuccessfully")})]}),(0,a.jsxs)("div",{className:"calculator-body artifact-stats",children:[u&&(0,a.jsxs)("div",{className:"textarea-group",children:[(0,a.jsxs)("fieldset",{children:[(0,a.jsxs)("legend",{children:[(0,a.jsx)("code",{children:"actor.ltx"}),ea&&O.length>0&&(0,a.jsxs)("span",{className:"parse-error-count",children:[Z("translation:errorsCount")," ",O.length]})]}),ea&&(0,a.jsxs)("div",{className:"text-area-controls-row",children:[(0,a.jsxs)("div",{className:"format-toggle",children:[(0,a.jsxs)("div",{className:"stalker-checkbox-container",children:[(0,a.jsx)("input",{id:"input_ActorFormatJson",checked:"json"===V,className:"stalker-checkbox-input",type:"radio",name:"actorFormat",value:"json",onChange:()=>W("json")}),(0,a.jsx)("label",{htmlFor:"input_ActorFormatJson",className:"stalker-checkbox-label",children:Z("translation:formatJson")})]}),(0,a.jsxs)("div",{className:"stalker-checkbox-container",children:[(0,a.jsx)("input",{id:"input_ActorFormatKey",checked:"keyvalue"===V,className:"stalker-checkbox-input",type:"radio",name:"actorFormat",value:"keyvalue",onChange:()=>W("keyvalue")}),(0,a.jsx)("label",{htmlFor:"input_ActorFormatKey",className:"stalker-checkbox-label",children:Z("translation:formatKeyValue")})]})]}),(0,a.jsxs)("div",{className:"text-area-controls",children:[(0,a.jsx)("button",{type:"button",className:"form-control",onClick:()=>{var e;let a=p?.actor?.actor_condition||p?.actor||{};y(e="json"===V?JSON.stringify(a,null,4):q(a)),Q(e,"actor")},disabled:!ea||!p?.actor,title:Z("translation:insertActorExampleButton"),children:Z("translation:insertActorExampleButton")}),(0,a.jsx)("button",{type:"button",className:"form-control",onClick:()=>{y(""),x(e=>e?{...e,actor:{}}:{...H}),L([]),K([])},disabled:!ea||!N,title:Z("translation:clearButton"),children:Z("translation:clearButton")})]})]}),(0,a.jsx)("textarea",{ref:R,id:"actorTextArea",className:"form-control actor-textarea",value:N,onChange:e=>{let a=e.target.value;console.log(a),y(a),u?.data?.slug==="empty"&&Q(a,"actor")},readOnly:!ea,wrap:"off",rows:12,spellCheck:"false",placeholder:ea?"json"===V?`Формат JSON:
{
    "health_restore_speed": 0.0003,
    "radiation_restore_speed": 0.004
}`:`Формат key=value:
health_restore_speed = 0.0003
radiation_restore_speed = 0.004`:""}),ea&&(0,a.jsxs)(a.Fragment,{children:[O.length>0&&(0,a.jsx)("div",{className:"parse-errors",children:O.map((e,t)=>(0,a.jsx)("div",{className:"parse-error-item",children:e},t))}),G.length>0&&(0,a.jsx)("div",{className:"parse-warnings",children:G.map((e,t)=>(0,a.jsx)("div",{className:"warning-item",children:e},t))})]})]}),u?.data?.dataFiles?.artifactsParams&&(0,a.jsxs)("fieldset",{children:[(0,a.jsxs)("legend",{children:[(0,a.jsx)("code",{children:"af_params.xml"}),ea&&B.length>0&&(0,a.jsxs)("span",{className:"parse-error-count",children:["Ошибок: ",B.length]})]}),ea&&(0,a.jsxs)("div",{className:"text-area-controls-row",children:[(0,a.jsxs)("div",{className:"format-toggle",children:[(0,a.jsxs)("div",{className:"stalker-checkbox-container",children:[(0,a.jsx)("input",{id:"input_artParamsFormatFormatJson",checked:"json"===M,className:"stalker-checkbox-input",type:"radio",name:"artParamsFormat",value:"json",onChange:()=>z("json")}),(0,a.jsx)("label",{htmlFor:"input_artParamsFormatFormatJson",className:"stalker-checkbox-label",children:Z("translation:formatJson")})]}),(0,a.jsxs)("div",{className:"stalker-checkbox-container",children:[(0,a.jsx)("input",{id:"input_artParamsFormatFormatKey",checked:"keyvalue"===M,className:"stalker-checkbox-input",type:"radio",name:"artParamsFormat",value:"keyvalue",onChange:()=>z("keyvalue")}),(0,a.jsx)("label",{htmlFor:"input_artParamsFormatFormatKey",className:"stalker-checkbox-label",children:Z("translation:formatKeyValue")})]})]}),(0,a.jsxs)("div",{className:"text-area-controls",children:[(0,a.jsx)("button",{type:"button",className:"form-control",onClick:()=>{let e;p?.artifactsParams&&(k(e="json"===M?JSON.stringify(p.artifactsParams,null,4):q(p.artifactsParams)),Q(e,"artifactsParams"))},disabled:!ea||!p?.artifactsParams,title:Z("translation:insertArtParamsExampleButton"),children:Z("translation:insertArtParamsExampleButton")}),(0,a.jsx)("button",{type:"button",className:"form-control",onClick:()=>{k(""),x(e=>e?{...e,artifactsParams:{}}:{...H}),J([]),I([])},disabled:!ea||!b,title:Z("translation:clearButton"),children:Z("translation:clearButton")})]})]}),(0,a.jsx)("textarea",{ref:R,id:"artParamsTextArea",className:"form-control art-params-textarea",value:b,onChange:e=>{let a=e.target.value;k(a),u?.data?.slug==="empty"&&Q(a,"artifactsParams")},readOnly:!ea,wrap:"off",rows:12,spellCheck:"false",placeholder:ea?"json"===M?`Формат JSON:
{
    "health_restore_speed": {
      "magnitude": 10000,
    }
}`:`Формат key=value:
health_restore_speed.min = 0.0001
health_restore_speed.max = 0.0005`:""}),ea&&(0,a.jsxs)(a.Fragment,{children:[B.length>0&&(0,a.jsx)("div",{className:"parse-errors",children:B.map((e,t)=>(0,a.jsx)("div",{className:"parse-error-item",children:e},t))}),D.length>0&&(0,a.jsx)("div",{className:"parse-warnings",children:D.map((e,t)=>(0,a.jsx)("div",{className:"warning-item",children:e},t))})]})]})]}),(0,a.jsxs)("div",{className:"textarea-group",children:[(0,a.jsxs)("fieldset",{className:"fieldset-art-stats",children:[(0,a.jsx)("legend",{children:(0,a.jsx)("code",{children:"items_artefacts.ltx"})}),(0,a.jsxs)("div",{className:"input-with-label",children:[(0,a.jsxs)("label",{htmlFor:"modInput",children:[Z("translation:modInputLabel"),":"]}),(0,a.jsx)("input",{id:"modInput",className:"form-control",type:"text",value:j,onChange:e=>f(e.target.value),placeholder:"modifiers",disabled:!p,autoComplete:"off"})]}),(0,a.jsxs)("div",{className:"input-with-label",children:[(0,a.jsx)("label",{htmlFor:"statsTextArea",children:Z("translation:artifactStatsInputLabel")}),(0,a.jsxs)("div",{className:"text-area-controls",children:[(0,a.jsx)("button",{type:"button",className:"form-control",onClick:()=>{var e=q({radiation_restore_speed:47e-5,power_restore_speed:-88e-5,bleeding_restore_speed:-124e-6,strike_immunity:.034,wound_immunity:.034,explosion_immunity:.034,fire_wound_immunity:.034});v(e),F(X(e)),setTimeout(()=>{R.current&&R.current.focus()},0)},disabled:!p,title:Z("translation:artifactExampleButton"),children:Z("translation:artifactExampleButton")}),(0,a.jsx)("button",{type:"button",className:"form-control",onClick:()=>{v(""),F([]),$([]),E([]),P({}),setTimeout(()=>{R.current&&R.current.focus()},0)},disabled:!p||!g,title:Z("translation:clearButton"),children:Z("translation:clearButton")})]})]}),(0,a.jsx)("textarea",{ref:R,id:"statsTextArea",className:"form-control stats-textarea",value:g,onChange:e=>{let a=e.target.value;v(a),a.trim()?F(X(a)):(F([]),$([]),E([]))},placeholder:`Введите параметры в формате:
ключ = значение  ; комментарий

Пример:
health_restore_speed = 0.0003 ; восстановление здоровья
radiation_restore_speed = 0.004   ; комментарии после ";" игнорируются`,disabled:!p,wrap:"off",rows:8,spellCheck:"false"})]}),(0,a.jsxs)("fieldset",{children:[(0,a.jsx)("legend",{children:(0,a.jsx)("code",{children:"Results"})}),(0,a.jsxs)("div",{className:"textarea-info",children:[(0,a.jsxs)("div",{className:"text_muted",children:[Z("translation:recognizedParamsCount")," ",_.length]}),A.length>0&&(0,a.jsxs)("div",{className:"parse-errors",children:[(0,a.jsx)("div",{className:"parse-errors-title",children:Z("translation:formatErrorsTitle")}),A.map((e,t)=>(0,a.jsx)("div",{className:"parse-error-item",children:e},t))]}),T.length>0&&(0,a.jsxs)("div",{className:"parse-warnings",children:[(0,a.jsx)("div",{className:"warnings-title",children:Z("translation:duplicateWarningsTitle")}),T.map((e,t)=>(0,a.jsx)("div",{className:"warning-item",children:e},t))]})]}),p?0===_.length?(0,a.jsx)("p",{className:"text_muted",children:Z("translation:enterParamsForCalculation")}):Object.keys(S).length>0?(0,a.jsx)("div",{className:"results-container",children:ee.map(e=>{let t=S[e],s=_.filter(a=>a.key===e);return(0,a.jsxs)("div",{className:"result-item",children:[(0,a.jsxs)("div",{className:"result-header",children:[(0,a.jsx)(c.default,{title:e,placement:"right",children:(0,a.jsx)("span",{className:"result-name",children:t?.name||e})}),s.length>1&&(0,a.jsxs)("span",{className:"duplicate-count",children:["(",s.length,"×)"]})]}),(0,a.jsx)("div",{className:"result-content",children:(0,a.jsx)("span",{className:"result-text",dangerouslySetInnerHTML:{__html:t?.text||'<span class="parse-errors">Не удалось рассчитать</span>'}})})]},e)})}):(0,a.jsx)("p",{className:"text_muted",children:Z("translation:enterDataForCalculation")}):(0,a.jsx)("p",{className:"text_muted",children:Z("translation:startCalculationsSelectGame")})]})]})]}),(0,a.jsx)("div",{className:"calculator-footer",children:Object.keys(Y).length>0&&(0,a.jsx)(i.default,{acTitle:Z("translation:debugAccordionTitle",{count:Object.keys(Y).length}),acBody:(0,a.jsxs)("div",{children:[(0,a.jsx)("pre",{style:{margin:0,whiteSpace:"pre-wrap"},children:JSON.stringify(Y,null,2)}),(0,a.jsxs)("div",{className:"debug-info",children:[(0,a.jsxs)("div",{children:[Z("translation:modifierLabel"),j||""]}),(0,a.jsxs)("div",{children:[Z("translation:errorsLabel"),A.length]}),(0,a.jsxs)("div",{children:[Z("translation:warningsLabel"),T.length]}),ea&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[Z("translation:actorWarningsLabel"),G.length]}),(0,a.jsxs)("div",{children:[Z("translation:artParamsWarningsLabel"),D.length]})]}),(0,a.jsxs)("div",{children:[Z("translation:gameTypeLabel")," ",ea?Z("translation:emptyGameType"):Z("translation:presetGameType")]}),ea&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[Z("translation:actorFormatLabel"),V]}),(0,a.jsxs)("div",{children:[Z("translation:artParamsFormatLabel"),M]})]})]})]}),additionalClass:"debug-accordion"})})]})]})}e.s(["default",()=>u])}]);